"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[507],{3507:(e,n,i)=>{i.r(n),i.d(n,{default:()=>A});var d=i(5043),s=i(3519),c=i(8628),l=i(1072),t=i(8602),a=i(4282),o=i(3814),r=i(4196),m=i(7491),p=i(5284),h=i(1894);var u=i(7936),x=i(579);const j=[{cod:"01",desc:"Cr\xe9dito"},{cod:"02",desc:"Contado"}],_=[{cod:"01",desc:"Atendido"}],A=()=>{const[e,n]=(0,d.useState)([]),[i,A]=(0,d.useState)([]),[g,b]=(0,d.useState)(1),[v]=(0,d.useState)(20),[f,y]=(0,d.useState)({num_pedido:"",num_cliente:"",des_cliente:"",fec_pedido:(new Date).toISOString().split("T")[0],cod_tipo_pago:"01",cod_estado:"01"}),[C,N]=(0,d.useState)(!1),[S,P]=(0,d.useState)(!1),[L,E]=(0,d.useState)(!1),[k,w]=(0,d.useState)(null);(0,d.useEffect)((()=>{I(),T()}),[]);const I=async()=>{const e=await(async()=>(0,h.A)("/api/v1/almacen/pedidos"))();n(e)},T=async()=>{const e=[...await(0,u.ys)(),{num_cliente:"999",nom_cliente:"Otros"}];A(e),e.length>0&&y((n=>({...n,num_cliente:e[0].num_cliente})))},G=e=>{const{name:n,value:i}=e.target;y({...f,[n]:i})},D=()=>!f.num_pedido||!f.num_pedido.startsWith("PA")||f.num_pedido.length>10?(alert('El n\xfamero de pedido debe comenzar con "PA" y tener m\xe1ximo 10 caracteres'),!1):f.num_cliente?"999"===f.num_cliente&&(!f.des_cliente||f.des_cliente.length>50)?(alert('La descripci\xf3n del cliente es obligatoria y no debe exceder 50 caracteres cuando se selecciona "Otros"'),!1):!!f.cod_tipo_pago||(alert("El tipo de pago es obligatorio"),!1):(alert("El cliente es obligatorio"),!1),O=()=>{N(!1),y({num_pedido:"",num_cliente:i.length>0?i[0].num_cliente:"",des_cliente:"",fec_pedido:(new Date).toISOString().split("T")[0],cod_tipo_pago:"01",cod_estado:"01"})},q=()=>{P(!1),y({num_pedido:"",num_cliente:"",des_cliente:"",fec_pedido:(new Date).toISOString().split("T")[0],cod_tipo_pago:"",cod_estado:"01"})},F=()=>E(!1),B=e=>{const n=i.find((n=>n.num_cliente===e));return n?`${n.nom_cliente}`:e},$=e=>{const n=j.find((n=>n.cod===e));return n?n.desc:e},H=e=>{const n=_.find((n=>n.cod===e));return n?n.desc:e},R=g*v,z=R-v,M=e.slice(z,R),U=Math.ceil(e.length/v),W=e=>{b(e)};return(0,x.jsxs)(s.A,{fluid:!0,className:"p-0",children:[(0,x.jsx)(c.A,{children:(0,x.jsxs)(c.A.Body,{className:"p-3",children:[(0,x.jsx)(c.A.Title,{className:"mb-3",children:"Pedidos"}),(0,x.jsx)(l.A,{className:"mb-3",children:(0,x.jsxs)(t.A,{xs:12,md:6,className:"d-flex align-items-center justify-content-start mb-2 mb-md-0",children:[(0,x.jsx)(a.A,{id:"agregarPedido",className:"mr-2",onClick:()=>{N(!0);const e=i.find((e=>e.num_cliente===f.num_cliente));y({num_pedido:"",num_cliente:i.length>0?i[0].num_cliente:"",des_cliente:e?e.nom_cliente:"",fec_pedido:(new Date).toISOString().split("T")[0],cod_tipo_pago:"01",cod_estado:"01"})},title:"Agregar",children:(0,x.jsx)("i",{className:"fa fa-plus"})}),(0,x.jsx)(o.A.Group,{className:"flex-grow-1",children:(0,x.jsx)(o.A.Control,{type:"text",placeholder:"Buscar",id:"txtBuscar",className:"rounded"})}),(0,x.jsx)(a.A,{type:"button",className:"btn btn-secondary ml-2",title:"Filtrar",children:(0,x.jsx)("i",{className:"fa fa-search"})})]})}),(0,x.jsxs)("div",{className:"table-responsive",id:"tabPedido",children:[(0,x.jsxs)(r.A,{children:[(0,x.jsx)("caption",{children:"Tabla de Pedidos"}),(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{children:"Opciones"}),(0,x.jsx)("th",{children:"N\xb0 Pedido"}),(0,x.jsx)("th",{children:"Cliente"}),(0,x.jsx)("th",{children:"Descripci\xf3n Cliente"}),(0,x.jsx)("th",{children:"Fecha"}),(0,x.jsx)("th",{children:"Tipo Pago"}),(0,x.jsx)("th",{children:"Estado"})]})}),(0,x.jsx)("tbody",{children:M.map(((e,n)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:z+n+1}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"btn-group",role:"group",children:[(0,x.jsx)(a.A,{type:"button",className:"btn btn-secondary btn-sm mb-1",title:"Editar",onClick:()=>(e=>{const n=i.find((n=>n.num_cliente===e.num_cliente));w(e),y({num_pedido:e.num_pedido,num_cliente:e.num_cliente,des_cliente:n?n.nom_cliente:e.des_cliente,fec_pedido:e.fec_pedido,cod_tipo_pago:e.cod_tipo_pago,cod_estado:e.cod_estado}),P(!0)})(e),children:(0,x.jsx)("i",{className:"fa fa-pencil"})}),(0,x.jsx)(a.A,{type:"button",className:"btn btn-danger btn-sm mb-1 ml-1",title:"Eliminar",onClick:()=>(e=>{w(e),E(!0)})(e),children:(0,x.jsx)("i",{className:"fa fa-trash-o"})})]})}),(0,x.jsx)("td",{children:e.num_pedido}),(0,x.jsx)("td",{children:B(e.num_cliente)}),(0,x.jsx)("td",{children:e.des_cliente}),(0,x.jsx)("td",{children:new Date(e.fec_pedido).toLocaleDateString()}),(0,x.jsx)("td",{children:$(e.cod_tipopago)}),(0,x.jsx)("td",{children:H(e.cod_estado)})]},n)))})]}),U>1&&(0,x.jsx)("div",{className:"d-flex justify-content-center mt-3",children:(0,x.jsxs)(m.A,{children:[(0,x.jsx)(m.A.First,{onClick:()=>W(1),disabled:1===g}),(0,x.jsx)(m.A.Prev,{onClick:()=>W(g-1),disabled:1===g}),[...Array(U)].map(((e,n)=>(0,x.jsx)(m.A.Item,{active:n+1===g,onClick:()=>W(n+1),children:n+1},n+1))),(0,x.jsx)(m.A.Next,{onClick:()=>W(g+1),disabled:g===U}),(0,x.jsx)(m.A.Last,{onClick:()=>W(U),disabled:g===U})]})})]})]})}),(0,x.jsxs)(p.A,{show:C,onHide:O,size:"lg",children:[(0,x.jsx)(p.A.Header,{closeButton:!0,children:(0,x.jsx)(p.A.Title,{children:"Registrar Pedido"})}),(0,x.jsxs)(o.A,{id:"formRegistro",autoComplete:"off",onSubmit:async e=>{if(e.preventDefault(),D()){const e={...f,cod_tipopago:f.cod_tipo_pago};delete e.cod_tipo_pago,await(async e=>(0,h.A)("/api/v1/almacen/pedidos","POST",e))(e),I(),O()}},children:[(0,x.jsx)(p.A.Body,{children:(0,x.jsxs)(l.A,{children:[(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"num_pedido",children:[(0,x.jsx)(o.A.Label,{children:"N\xfamero de Pedido"}),(0,x.jsx)(o.A.Control,{type:"text",name:"num_pedido",value:f.num_pedido,onChange:G,required:!0,maxLength:10,placeholder:"PA0001"})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"num_cliente",children:[(0,x.jsx)(o.A.Label,{children:"Cliente"}),(0,x.jsxs)(o.A.Select,{name:"num_cliente",value:f.num_cliente,onChange:G,required:!0,children:[(0,x.jsx)("option",{value:"",children:"Seleccione un cliente"}),i.map((e=>(0,x.jsxs)("option",{value:e.num_cliente,children:[e.num_cliente,"-",e.nom_cliente]},e.num_cliente)))]})]})}),"999"===f.num_cliente&&(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"des_cliente",children:[(0,x.jsx)(o.A.Label,{children:"Descripci\xf3n del Cliente"}),(0,x.jsx)(o.A.Control,{type:"text",name:"des_cliente",value:f.des_cliente,onChange:G,maxLength:50,required:!0})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"fec_pedido",children:[(0,x.jsx)(o.A.Label,{children:"Fecha de Pedido"}),(0,x.jsx)(o.A.Control,{type:"date",name:"fec_pedido",value:f.fec_pedido,onChange:G,disabled:!0})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"cod_tipo_pago",children:[(0,x.jsx)(o.A.Label,{children:"Tipo de Pago"}),(0,x.jsxs)(o.A.Select,{name:"cod_tipo_pago",value:f.cod_tipo_pago,onChange:G,required:!0,children:[(0,x.jsx)("option",{value:"",children:"Seleccione tipo de pago"}),j.map((e=>(0,x.jsx)("option",{value:e.cod,children:e.desc},e.cod)))]})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"cod_estado",children:[(0,x.jsx)(o.A.Label,{children:"Estado"}),(0,x.jsx)(o.A.Select,{name:"cod_estado",value:f.cod_estado,onChange:G,disabled:!0,children:_.map((e=>(0,x.jsx)("option",{value:e.cod,children:e.desc},e.cod)))})]})})]})}),(0,x.jsxs)(p.A.Footer,{children:[(0,x.jsx)(a.A,{type:"submit",variant:"outline-primary",children:" Registrar "}),(0,x.jsx)(a.A,{variant:"outline-secondary",onClick:O,children:" Cancelar "})]})]})]}),(0,x.jsxs)(p.A,{show:S,onHide:q,size:"lg",children:[(0,x.jsx)(p.A.Header,{closeButton:!0,children:(0,x.jsx)(p.A.Title,{children:"Editar Pedido"})}),(0,x.jsxs)(o.A,{id:"formEditar",autoComplete:"off",onSubmit:async e=>{if(e.preventDefault(),D()){const e={...f,cod_tipopago:f.cod_tipo_pago};delete e.cod_tipo_pago,await(async(e,n)=>(0,h.A)(`/api/v1/almacen/pedidos/${e}`,"PUT",n))(k.num_pedido,e),I(),q()}},children:[(0,x.jsx)(p.A.Body,{children:(0,x.jsxs)(l.A,{children:[(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"num_pedido",children:[(0,x.jsx)(o.A.Label,{children:"N\xfamero de Pedido"}),(0,x.jsx)(o.A.Control,{type:"text",name:"num_pedido",value:f.num_pedido,onChange:G,required:!0,maxLength:10,placeholder:"PA0001"})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"num_cliente",children:[(0,x.jsx)(o.A.Label,{children:"Cliente"}),(0,x.jsxs)(o.A.Select,{name:"num_cliente",value:f.num_cliente,onChange:G,required:!0,children:[(0,x.jsx)("option",{value:"",children:"Seleccione un cliente"}),i.map((e=>(0,x.jsxs)("option",{value:e.num_cliente,children:[e.num_cliente,"-",e.nom_cliente]},e.num_cliente)))]})]})}),"999"===f.num_cliente&&(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"des_cliente",children:[(0,x.jsx)(o.A.Label,{children:"Descripci\xf3n del Cliente"}),(0,x.jsx)(o.A.Control,{type:"text",name:"des_cliente",value:f.des_cliente,onChange:G,maxLength:50,required:!0})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"fec_pedido",children:[(0,x.jsx)(o.A.Label,{children:"Fecha de Pedido"}),(0,x.jsx)(o.A.Control,{type:"date",name:"fec_pedido",value:f.fec_pedido,onChange:G})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"cod_tipo_pago",children:[(0,x.jsx)(o.A.Label,{children:"Tipo de Pago"}),(0,x.jsxs)(o.A.Select,{name:"cod_tipo_pago",value:f.cod_tipo_pago,onChange:G,required:!0,children:[(0,x.jsx)("option",{value:"",children:"Seleccione tipo de pago"}),j.map((e=>(0,x.jsx)("option",{value:e.cod,children:e.desc},e.cod)))]})]})}),(0,x.jsx)(t.A,{md:6,className:"mb-3",children:(0,x.jsxs)(o.A.Group,{controlId:"cod_estado",children:[(0,x.jsx)(o.A.Label,{children:"Estado"}),(0,x.jsx)(o.A.Select,{name:"cod_estado",value:f.cod_estado,onChange:G,required:!0,children:_.map((e=>(0,x.jsx)("option",{value:e.cod,children:e.desc},e.cod)))})]})})]})}),(0,x.jsxs)(p.A.Footer,{children:[(0,x.jsx)(a.A,{type:"submit",variant:"outline-primary",children:" Guardar "}),(0,x.jsx)(a.A,{variant:"outline-secondary",onClick:q,children:" Cancelar "})]})]})]}),(0,x.jsxs)(p.A,{show:L,onHide:F,children:[(0,x.jsx)(p.A.Header,{closeButton:!0,children:(0,x.jsx)(p.A.Title,{children:"Eliminar Pedido"})}),(0,x.jsxs)(p.A.Body,{children:["\xbfEst\xe1s seguro de que deseas eliminar el pedido:"," ",(0,x.jsx)("strong",{children:k&&k.num_pedido}),"?"]}),(0,x.jsxs)(p.A.Footer,{children:[(0,x.jsx)(a.A,{variant:"danger",onClick:async()=>{await(async e=>(0,h.A)(`/api/v1/almacen/pedidos/${e}`,"DELETE"))(k.num_pedido),I(),E(!1)},children:" Eliminar "}),(0,x.jsx)(a.A,{variant:"secondary",onClick:F,children:" Cancelar "})]})]})]})}},7936:(e,n,i)=>{i.d(n,{GP:()=>l,MW:()=>c,OE:()=>t,ys:()=>s});var d=i(1894);const s=async()=>(0,d.A)("/api/v1/ventas/clientes"),c=async e=>(0,d.A)("/api/v1/ventas/clientes","POST",e),l=async(e,n)=>(0,d.A)(`/api/v1/ventas/clientes/${e}`,"PUT",n),t=async e=>(0,d.A)(`/api/v1/ventas/clientes/${e}`,"DELETE")},7491:(e,n,i)=>{i.d(n,{A:()=>A});var d=i(8139),s=i.n(d),c=i(5043),l=i(7852),t=i(6161),a=i(579);const o=c.forwardRef(((e,n)=>{let{active:i=!1,disabled:d=!1,className:c,style:l,activeLabel:o="(current)",children:r,linkStyle:m,linkClassName:p,as:h=t.A,...u}=e;const x=i||d?"span":h;return(0,a.jsx)("li",{ref:n,style:l,className:s()(c,"page-item",{active:i,disabled:d}),children:(0,a.jsxs)(x,{className:s()("page-link",p),style:m,...u,children:[r,i&&o&&(0,a.jsx)("span",{className:"visually-hidden",children:o})]})})}));o.displayName="PageItem";const r=o;function m(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const d=c.forwardRef(((e,d)=>{let{children:s,...c}=e;return(0,a.jsxs)(o,{...c,ref:d,children:[(0,a.jsx)("span",{"aria-hidden":"true",children:s||n}),(0,a.jsx)("span",{className:"visually-hidden",children:i})]})}));return d.displayName=e,d}const p=m("First","\xab"),h=m("Prev","\u2039","Previous"),u=m("Ellipsis","\u2026","More"),x=m("Next","\u203a"),j=m("Last","\xbb"),_=c.forwardRef(((e,n)=>{let{bsPrefix:i,className:d,size:c,...t}=e;const o=(0,l.oU)(i,"pagination");return(0,a.jsx)("ul",{ref:n,...t,className:s()(d,o,c&&`${o}-${c}`)})}));_.displayName="Pagination";const A=Object.assign(_,{First:p,Prev:h,Ellipsis:u,Item:r,Next:x,Last:j})}}]);
//# sourceMappingURL=507.b5bd0e71.chunk.js.map